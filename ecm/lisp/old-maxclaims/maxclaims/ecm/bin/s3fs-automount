#!/bin/sh
S3PATH=$1 ;
S3MOUNT=$(cat /ecm/etc/s3fstab | awk '{if (sub(/\\$/,"")) printf "%s", $0; else print $0}'|grep $S3PATH |awk '{$1="s3fs";print $0}')
S3MOUNTPOINT=$(echo $S3MOUNT | awk '{print $3}')

# echo $S3MOUNTPOINT ; exit;
if [ -z "$S3MOUNT" ] ; then
   echo "$S3PATH is not in s3fstab, so not s3 based.";
 elif mountpoint -q $S3MOUNTPOINT  ; then
   echo $S3MOUNTPOINT is already mounted;
else   echo "mounting $S3PATH"
  mkdir -p $S3MOUNTPOINT;
  eval $S3MOUNT 
fi
